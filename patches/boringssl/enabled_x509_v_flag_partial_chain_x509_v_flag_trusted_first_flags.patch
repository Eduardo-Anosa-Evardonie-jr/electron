From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Ubuntu <ubuntu@ip-172-31-61-0.ec2.internal>
Date: Fri, 5 Jun 2020 10:13:22 +0000
Subject: Enabled X509_V_FLAG_PARTIAL_CHAIN & X509_V_FLAG_TRUSTED_FIRST flags


diff --git a/crypto/x509/x509_vfy.c b/crypto/x509/x509_vfy.c
index fff97fac993e0b2a4af2f4965f65206fc6556fcb..efd431490aa9d6f43288988dbec6cd9071e7ad62 100644
--- a/crypto/x509/x509_vfy.c
+++ b/crypto/x509/x509_vfy.c
@@ -270,7 +270,7 @@ int X509_verify_cert(X509_STORE_CTX *ctx)
         /*
          * If asked see if we can find issuer in trusted store first
          */
-        if (ctx->param->flags & X509_V_FLAG_TRUSTED_FIRST) {
+        if (1) {
             ok = ctx->get_issuer(&xtmp, ctx, x);
             if (ok < 0) {
                 ctx->error = X509_V_ERR_STORE_LOOKUP;
@@ -407,7 +407,7 @@ int X509_verify_cert(X509_STORE_CTX *ctx)
          */
         retry = 0;
         if (trust != X509_TRUST_TRUSTED
-            && !(ctx->param->flags & X509_V_FLAG_TRUSTED_FIRST)
+            && !(1)
             && !(ctx->param->flags & X509_V_FLAG_NO_ALT_CHAINS)) {
             while (j-- > 1) {
                 xtmp2 = sk_X509_value(ctx->chain, j - 1);
@@ -891,7 +891,7 @@ static int check_trust(X509_STORE_CTX *ctx)
      * If we accept partial chains and have at least one trusted certificate
      * return success.
      */
-    if (ctx->param->flags & X509_V_FLAG_PARTIAL_CHAIN) {
+    if (1) {
         X509 *mx;
         if (ctx->last_untrusted < (int)sk_X509_num(ctx->chain))
             return X509_TRUST_TRUSTED;
@@ -1821,7 +1821,7 @@ static int internal_verify(X509_STORE_CTX *ctx)
     if (ctx->check_issued(ctx, xi, xi))
         xs = xi;
     else {
-        if (ctx->param->flags & X509_V_FLAG_PARTIAL_CHAIN) {
+        if (1) {
             xs = xi;
             goto check_cert;
         }
